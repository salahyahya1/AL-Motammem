<section id="blog-view" class="w-full bg-[#F8F9FB] py-17 md:py-16">
    <div class="max-w-3xl mx-auto px-4 md:px-6 lg:px-0 text-right">
        @if (loading) {
        <div class="py-16 text-center text-[#6B7280]">
            جاري تحميل المقال...
        </div>
        } @else if (errorMsg) {
        <div class="py-16 text-center text-red-600">
            {{ errorMsg }}
        </div>
        } @else if (blog) {
        <div>
            <header class="mb-6 md:mb-8">
                <div class="flex justify-between">
                    <h1 class="text-[var(--primary,#2563EB)]
                 text-2xl md:text-3xl font-bold mb-3 leading-relaxed">
                        {{blog.title}}
                    </h1>
                    @if (isAuthenticated && hasrole) {
                    <div class="flex justify-center gap-2">
                        @if (role === 'SuperAdmin'|| role === 'Admin' ) {
                        <a [routerLink]="['/blogs/EditBlog', blog.englishURL]" (click)="StoreSource()"
                            class="inline-flex items-center justify-center  px-0 py-1.5 rounded-full cursor-pointer">
                            <svg width="25px" height="25px" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                                <g id="SVGRepo_iconCarrier">
                                    <path
                                        d="M9 5H7C5.89543 5 5 5.89543 5 7V19C5 20.1046 5.89543 21 7 21H9M15 5H17C18.1046 5 19 5.89543 19 7V9"
                                        stroke="oklch(50% 0.134 242.749) " stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round"></path>
                                    <path
                                        d="M14.902 20.3343L12.7153 20.7716L13.1526 18.585C13.1914 18.3914 13.2865 18.2136 13.4261 18.074L17.5 14L19.5 12L21.4869 13.9869L19.4869 15.9869L15.413 20.0608C15.2734 20.2004 15.0956 20.2956 14.902 20.3343Z"
                                        stroke="oklch(50% 0.134 242.749)" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round"></path>
                                    <path d="M9 5C9 3.89543 9.89543 3 11 3H13C14.1046 3 15 3.89543 15 5V7H9V5Z"
                                        stroke="oklch(50% 0.134 242.749)" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round"></path>
                                </g>
                            </svg>
                        </a>
                        }
                        @if(role === 'SuperAdmin'){
                        <button type="button" (click)="openDeletePopover($event, blog.id)" class="inline-flex items-center justify-center px-0 py-1.5
                                                    rounded-full cursor-pointer">
                            <svg width="25px" height="25px" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                                <g id="SVGRepo_iconCarrier">
                                    <path
                                        d="M18 6L17.1991 18.0129C17.129 19.065 17.0939 19.5911 16.8667 19.99C16.6666 20.3412 16.3648 20.6235 16.0011 20.7998C15.588 21 15.0607 21 14.0062 21H9.99377C8.93927 21 8.41202 21 7.99889 20.7998C7.63517 20.6235 7.33339 20.3412 7.13332 19.99C6.90607 19.5911 6.871 19.065 6.80086 18.0129L6 6M4 6H20M16 6L15.7294 5.18807C15.4671 4.40125 15.3359 4.00784 15.0927 3.71698C14.8779 3.46013 14.6021 3.26132 14.2905 3.13878C13.9376 3 13.523 3 12.6936 3H11.3064C10.477 3 10.0624 3 9.70951 3.13878C9.39792 3.26132 9.12208 3.46013 8.90729 3.71698C8.66405 4.00784 8.53292 4.40125 8.27064 5.18807L8 6M14 10V17M10 10V17"
                                        stroke="red" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    </path>
                                </g>
                            </svg>
                            <!-- </a> -->
                        </button>

                        }
                    </div>
                    }
                </div>
                <p class="text-[#6B7280] text-sm md:text-base leading-relaxed">
                    {{blog.metaDescription}}
                </p>
            </header>

            <div
                class="w-full h-48 md:h-60 lg:h-64 rounded-3xl bg-[#E5E7EB] flex items-center justify-center mb-8 md:mb-10 overflow-hidden">
                <img src="{{blog.mainImage}}" alt="{{blog.title}}" class="w-full h-full object-cover">
            </div>

            <article
                class="bg-[#2563EB] rounded-3xl px-5 py-6 md:px-10 md:py-8 text-right text-white space-y-5 md:space-y-6">

                <!-- <section>
                <h2 class="text-sm md:text-base font-bold mb-1.5 text-[#FACC15]">
                    سهولة الوصول من أي مكان
                </h2>
                <p class="text-xs md:text-sm leading-relaxed">
                    توفر الأنظمة السحابية إمكانية الوصول للبيانات من أي جهاز وفي أي وقت، مما يسهل العمل عن بُعد ويسمح
                    للمديرين بمراجعة التقارير المالية فورًا بدون الحاجة لوجودهم داخل المكتب.
                </p>
                <h3 class="text-sm md:text-base font-bold mb-1.5 inline-block text-[#25E9F7]">
                    كيف يساعد ذلك فريق المحاسبة؟
                </h3>
                <p class="text-xs md:text-sm leading-relaxed inline">
                    ببساطة، يستطيع الفريق تحديث البيانات لحظيًا، مما يمنع ازدواجية العمل ويقلل احتمالية الأخطاء في
                    المراجعات
                    الدورية.
                </p>
            </section> -->
                <section class="blog-content" [innerHTML]="blogHtml"></section>


                <!-- <section>
                <h2 class="text-sm md:text-base font-bold mb-1.5 text-[#FACC15]">
                    كيف يساعد ذلك فريق المحاسبة؟
                </h2>
                <p class="text-xs md:text-sm leading-relaxed">
                    ببساطة، يستطيع الفريق تحديث البيانات لحظيًا، مما يمنع ازدواجية العمل ويقلل احتمالية الأخطاء في
                    المراجعات
                    الدورية.
                </p>
            </section> -->

                <!-- <section>
                <h2 class="text-sm md:text-base font-bold mb-1.5 text-[#FACC15]">
                    أمان وحماية بيانات أعلى
                </h2>
                <div>
                    <p class="text-xs md:text-sm leading-relaxed">
                        توفر الأنظمة السحابية عادةً مستويات أمان متقدمة مثل التشفير، النسخ الاحتياطي التلقائي، وتحديد
                        الصلاحيات.
                        هذه المميزات تجعل بيانات شركتك أكثر أمانًا من الطرق التقليدية،
                    </p>
                    <h4 class="inline-block text-[#25E9F7]">تحديثات الأمان التلقائية:</h4>
                    <p class="inline"> النظام يقوم بتحديثات مستمرة بدون الحاجة لأي تدخل من الشركة، مما يحمي البيانات من
                        الاختراقات المحتملة</p>
                </div>
            </section>
            <section>
                <h2 class="text-sm md:text-base font-bold mb-1.5 text-[#FACC15]">
                    تقارير مالية لحظية وقرارات أسرع​
                </h2>
                <div>
                    <p class="text-xs md:text-sm leading-relaxed">
                        تسمح الأنظمة السحابية بالحصول على تقارير فورية دقيقة تعكس وضع الشركة الحقيقي، مما يسهّل اتخاذ
                        قرارات سريعة بناءً على بيانات موثوقة.​
                    </p>
                </div>
            </section> -->
            </article>
            <section>
                @for (FAQ of (blog.faqs ?? []); track $index) {
                <app-accordion [title]="isRtl ? FAQ.question : FAQ.englishQuestion">
                    {{isRtl ? FAQ.answer : FAQ.englishAnswer}}
                </app-accordion>
                }
            </section>
            <div class="mt-8 md:mt-10 text-center">
                <button class="inline-flex items-center justify-center px-8 md:px-10 py-3 md:py-3.5 rounded-full
               bg-[#2563EB] text-white font-semibold text-sm md:text-base shadow-md
               hover:bg-[#1D4ED8] transition mb-3">
                    {{'BLOG_VIEW.CTA.BUTTON' | translate}}
                </button>

                <p class="text-[#6B7280] text-xs md:text-sm mb-1">
                    {{'BLOG_VIEW.CTA.LINE1' | translate}}
                </p>
                <p class="text-[#2563EB] text-xs md:text-sm font-semibold">
                    {{'BLOG_VIEW.CTA.LINE2' | translate}}
                </p>
            </div>
        </div>
        }
    </div>
</section>
<ng-template #deleteConfirmTpl2>
    <div dir="rtl" id="deleteConfirm" class="bg-white border border-gray-200 shadow-xl rounded-xl w-80 p-4">
        <div class="flex items-start gap-3">
            <span class="text-xl">ℹ️</span>
            <p class="text-sm text-gray-700 text-right flex-1">
                {{"BLOGS.DELETE_CONFIRM.MESSAGE" | translate}}
            </p>
        </div>

        <div class="flex justify-end gap-2 mt-4">
            <button class="h-9 px-4 rounded-lg border border-gray-300 text-sm hover:bg-gray-50"
                (click)="closeDeletePopover()">
                {{"BLOGS.DELETE_CONFIRM.NO" | translate}}
            </button>

            <button class="h-9 px-4 rounded-lg bg-red-600 text-white text-sm hover:bg-red-500"
                (click)="confirmDeletePopover()">
                {{"BLOGS.DELETE_CONFIRM.YES" | translate}}
            </button>
        </div>
    </div>
</ng-template>

<app-messege-dialog [open]="dialogOpen" [isFaqsPage]="true" [variant]="dialogVariant" [title]="dialogTitle"
    [message]="dialogMessage" [buttons]="dialogButtons" (closed)="closeDialog()" (action)="onDialogAction($event)">
</app-messege-dialog>